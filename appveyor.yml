version: 0.0.0+{build}

skip_tags: true

matrix:
  fast_finish: true

environment:
  NVM_HOME: C:\Users\appveyor\AppData\Roaming\nvm
  POWERSHELL_GALLERY_API_KEY:
    secure: Y7B8n8Ott858qlg1xt1Kz7VnvR59aO963p5dquIEQsMUZpvK/Ip5Rmj7G/jBKM6r
  GITHUB_ACCESS_TOKEN:
    secure: cEpuAn4TbJ17Y4WMMsHj46T4DLFMGE4n7xafkbiVQL4jueqc9TGG7NHWg4qbwmt7
  matrix:
  - APPVEYOR_BUILD_WORKER_IMAGE: Ubuntu1804
    LANG: us_US.UTF-8
    APPVEYOR_SSH_KEY: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCnc5rdUzg/RzExbFYvmyMSoaR6GEfWdwVSC5RDcddzm1t0UZAkZzzH3j7p0vJX4nnOqAVouToQw9PFvJmndN/jU8EkeREjtB7qhTbMBUGodmXQSG0sDIsqWRq/uVdKT++qZmjtBTASO9k9BUwk+/REMok+X3Np3FmvGxEGcWQsTqbZkQH93Wd2X6LgD9bnmdvdz2x/9RYXCm6PR0tgAru5nxFhiqIYmFdr/pQ2//HLTmNb5KX0sjNI+je7sunjUNahVYOKRJueoFgSC70OaRRY9s/WBYAhQXHv/m/rMObcq6N39GZHW+cv2LqIiM2KxqPP3nlQI7058Y/UXknIaTRd ajensen@04-PC0NXXGR
  - APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2017

build_script:
- sh: export APPVEYOR_SSH_BLOCK=true
- sh: curl -sflL 'https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-ssh.sh' | bash -e -
- pwsh: >-
    # $blockRdp = $true; iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))
    
    # On Linux, progress bars still show when running on the build server and take *ages* to render and they screw up the displayed output.
    $ProgressPreference = 'SilentlyContinue'
    
    .\build.ps1 -Verbose

test: off

artifacts:
- path: .output\pester*.xml
  name: TestResults
- path: .output\*.zip
  name: Packages
- path: .output\msbuild.*.log

notifications:
- provider: Email
  to:
  - aaron@splatteredbits.com
  - ajensen@webmd.net
  on_build_success: false
  on_build_failure: false
  on_build_status_changed: false